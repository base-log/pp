<!DOCTYPE html>
<html lang="ko">
<head>
<meta name="robots" content="noindex, nofollow">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AI 회의록 변환기 PRO</title>

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>✨</text></svg>">

<link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.8/dist/web/static/pretendard.css" />

<style>
    #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #1a202c; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 99999; font-family: -apple-system, BlinkMacSystemFont, "Pretendard", sans-serif; }
    .login-box { background: rgba(255, 255, 255, 0.05); padding: 50px 40px; border-radius: 20px; text-align: center; border: 1px solid rgba(255, 255, 255, 0.1); box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5); backdrop-filter: blur(10px); width: 320px; }
    .login-title { color: white; font-size: 22px; font-weight: 700; margin: 0 0 30px 0; letter-spacing: -0.5px; }
    .pass-input { width: 100%; padding: 12px; margin-bottom: 15px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 8px; color: white; font-size: 14px; outline: none; text-align: center; }
    .pass-input:focus { border-color: #F0D798; }
    .login-btn { width: 100%; padding: 12px; border: none; border-radius: 8px; background: linear-gradient(135deg, #F0D798 0%, #E0C070 100%); color: #451a03; font-weight: 800; cursor: pointer; font-size: 15px; transition: transform 0.1s; }
    .login-btn:active { transform: scale(0.96); }
    .error-msg { color: #fc8181; font-size: 12px; margin-top: 15px; min-height: 18px; font-weight: 600; opacity: 0; transition: opacity 0.2s; }
    @keyframes shake { 0% { transform: translateX(0); } 25% { transform: translateX(-5px); } 50% { transform: translateX(5px); } 75% { transform: translateX(-5px); } 100% { transform: translateX(0); } }
</style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h2 class="login-title">AI 변환기 접속</h2>
        <input type="password" id="userPass" class="pass-input" placeholder="입장 코드를 입력하세요" onkeypress="handleEnter(event)">
        <button class="login-btn" onclick="checkLogin()">접속하기</button>
        <div id="errorMsg" class="error-msg">⛔ 코드가 일치하지 않습니다</div>
    </div>
</div>

<script>

    var _p_target = "dXNpbV9zZWNyZXRfa2V5XzIwMjc="; 

    var _sys_token_v2 = 1803859200000; // 
    
    if (new Date().getTime() > _sys_token_v2) {
        alert("⛔ System Access Denied (Code: 005)");
        document.write('<style>body{background:#1a202c;color:#fff;display:flex;justify-content:center;align-items:center;height:100vh;text-align:center;font-family:sans-serif;}</style><div><h1 style="font-size:50px;">🚫</h1><h2>Access Token Expired</h2><p style="color:#a0aec0;">라이선스가 만료되었습니다. (2027.02.28)</p></div>');
        throw new Error("System Halted");
    }

    // [로그인 체크 로직 - 호환성 100% 솔트 난독화]
    function checkLogin() {
        var input = document.getElementById('userPass').value;
        var errorMsg = document.getElementById('errorMsg');
        var overlay = document.getElementById('login-overlay');

        if(!input) {
             document.getElementById('userPass').focus();
             return;
        }

        // 1. 단순 비교 대신 '소금(Salt)'을 쳐서 변환 (소스보기 방지)
        // 사용자가 입력한 값 뒤에 몰래 "_secret_key_2027"을 붙여서 변환함
        var _salt = "_secret_key_2027";
        
        try {
            // btoa(Base64) 변환을 사용하여 어떤 브라우저에서도 작동 보장
            var _input_encoded = btoa(unescape(encodeURIComponent(input + _salt)));

            // 2. 변환된 값끼리 비교
            if (_input_encoded === _p_target) {
                // [성공]
                overlay.style.transition = "opacity 0.5s";
                overlay.style.opacity = "0";
                setTimeout(function() { overlay.style.display = "none"; }, 500);
                
            } else {
                throw new Error("Wrong Password");
            }
        } catch(e) {
            // [실패]
            errorMsg.style.opacity = "1";
            var box = document.querySelector('.login-box');
            box.style.animation = "shake 0.4s";
            setTimeout(() => box.style.animation = "", 400);
            document.getElementById('userPass').value = "";
            document.getElementById('userPass').focus();
        }
    }

    function handleEnter(e) { if (e.key === 'Enter') checkLogin(); }
    
    // ==========================================
    // [기타 초기화 로직]
    // ==========================================
    window.addEventListener('load', function() {
        // 날짜 자동입력 실행
        if(typeof setToday === 'function') setToday();

        // 입력창 포커스
        var passInput = document.getElementById('userPass');
        if(passInput && document.getElementById('login-overlay').style.display !== 'none') { 
            passInput.focus(); 
        }
    });
    
    /* [편의기능] 마지막 입력값 자동 저장/불러오기 */
    function loadSavedData() {
        const fields = ['info_title', 'info_purpose', 'info_room', 'info_attendees'];
        fields.forEach(id => {
            const saved = localStorage.getItem(id);
            if (saved && document.getElementById(id)) document.getElementById(id).value = saved;
        });
    }
    function setupAutoSave() {
        const fields = ['info_title', 'info_purpose', 'info_room', 'info_attendees'];
        fields.forEach(id => {
            const el = document.getElementById(id);
            if(el) {
                el.addEventListener('input', function(e) {
                    localStorage.setItem(id, e.target.value);
                });
            }
        });
    }
</script>

<style>
  :root {
    --app-bg: #eef2f6;           
    --sidebar-bg-start: #2d3748; 
    --sidebar-bg-end: #1a202c;       
    --main-bg: #ffffff;
    --accent: #F0D798;           
    --accent-hover: #E0C070;     
    --accent-glow: rgba(240, 215, 152, 0.5); 
    --border: #e2e8f0;
    --radius: 14px; 
    --shadow-window: 0 20px 45px -10px rgba(0, 0, 0, 0.4); 
    --shadow-float: 0 8px 20px -3px rgba(0, 0, 0, 0.1);
  }

  * { box-sizing: border-box; outline: none; }
  
  ::-webkit-scrollbar { width: 7px; height: 7px; } 
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgba(148, 163, 184, 0.5); border-radius: 4px; }
  ::-webkit-scrollbar-thumb:hover { background: rgba(148, 163, 184, 0.8); }

  body {
    font-family: 'Pretendard', sans-serif;
    background-color: var(--app-bg);
    margin: 0; padding: 0;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow-x: hidden; 
  }

  .app-window {
    width: 1380px; 
    height: 85vh;        
    max-height: 880px; 
    min-height: 680px; 
    background: white;
    border-radius: var(--radius);
    box-shadow: var(--shadow-window);
    display: flex;
    overflow: hidden;
    border: 1px solid #cfd8e3; 
    position: relative;
  }

  /* [좌측 사이드바] */
  .sidebar {
    width: 405px; 
    /* 기본(회의) 모드 배경: 다크 네이비 */
    background: linear-gradient(170deg, var(--sidebar-bg-start) 0%, #171923 100%); 
    padding: 50px 32px; 
    display: flex;
    flex-direction: column;
    color: #f8fafc;
    flex-shrink: 0;
    z-index: 2;
    box-shadow: 10px 0 30px rgba(0,0,0,0.25); 
    position: relative;
    overflow: hidden; 
    justify-content: center;
    
    /* 배경색 부드러운 전환 효과 */
    transition: background 0.6s cubic-bezier(0.25, 0.8, 0.25, 1);
  }
  
  /* [수정] 출장 모드 테마: 딥 스틸 (Slate Teal / Deep Steel) */
  /* 차분하고 지적인 느낌의 딥 틸/스틸 컬러. 골드와 하얀색 텍스트가 매우 선명하게 보임 */
  .trip-skin {
  background: linear-gradient(135deg, #172554 0%, #0f172a 100%) !important;
  }
  
  .sidebar::before {
    content: '';
    position: absolute;
    top: -50%; left: -50%;
    width: 200%; height: 200%;
    background: radial-gradient(circle, rgba(255,255,255,0.03) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  .brand { margin-bottom: 25px; position: relative; z-index: 1; flex-shrink: 0; }
  
  /* H1을 Flex 컨테이너로 만들어 양쪽 정렬 */
  .brand h1 {
    font-size: 23px; font-weight: 800; margin: 0 0 7px 0; letter-spacing: -0.5px; 
    display: flex; 
    justify-content: space-between; /* 양끝 정렬 */
    align-items: center; 
    width: 100%; /* 가로 꽉 채우기 */
    color: white; text-shadow: 0 2px 4px rgba(0,0,0,0.3);
  }
  
  /* 토글 스위치 스타일 */
  .mode-switch-container {
    display: inline-flex;
    position: relative;
    background: rgba(0, 0, 0, 0.4);
    border-radius: 6px;
    padding: 2px;
    cursor: pointer;
    width: 90px; 
    height: 22px;
    vertical-align: middle;
    box-shadow: inset 0 1px 3px rgba(0,0,0,0.3);
    border: 1px solid rgba(255,255,255,0.1);
  }

  .mode-switch-slider {
    position: absolute;
    left: 2px; top: 2px; bottom: 2px;
    width: 42px;
    background: var(--accent);
    border-radius: 4px;
    transition: transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1);
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
  }

  .mode-labels {
    position: relative;
    display: flex;
    width: 100%;
    height: 100%;
    font-size: 10px;
    font-weight: 800;
    justify-content: space-between;
    align-items: center;
    z-index: 1;
  }

  .mode-label-text {
    flex: 1;
    text-align: center;
    color: #94a3b8;
    transition: color 0.3s;
    user-select: none;
  }

  .mode-label-text.active {
    color: #451a03; /* 강조 텍스트 색상 */
  }

  /* 토글 상태 클래스 (JS로 제어) */
  .mode-switch-container.trip-mode .mode-switch-slider {
    transform: translateX(44px);
  }

  .brand p { margin: 0; font-size: 13px; color: #94a3b8; font-weight: 400; opacity: 0.8; letter-spacing: 0px; }

  .input-scroll-area {
    position: relative; z-index: 1; flex-grow: 0; 
    display: flex; flex-direction: column; gap: 14px; margin-bottom: 25px; 
  }
  .form-group { margin: 0; }
  .label {
    display: flex; justify-content: space-between; align-items: center;
    font-size: 11px; font-weight: 700; color: #a0aec0; margin-bottom: 5px; text-transform: uppercase; letter-spacing: 1px;
  }
  .clear-btn { cursor: pointer; font-size: 10px; color: #64748b; background: none; border: none; padding: 0; }
  
  .input-field {
    width: 100%; height: 40px; background: rgba(0, 0, 0, 0.2); 
    border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 7px; padding: 8px 14px; 
    color: #ffffff; font-size: 13px; font-family: inherit; line-height: 1.5; resize: none; overflow-y: hidden; 
    transition: all 0.2s ease; backdrop-filter: blur(10px);
  }
  .input-field:focus {
    background: rgba(0, 0, 0, 0.4); border-color: var(--accent); box-shadow: 0 0 0 2px var(--accent-glow); color: white; 
  }
  
  .process-divider {
    display: flex; align-items: center; gap: 12px; margin: 8px 0 16px 0; 
    color: var(--accent); font-size: 10px; font-weight: 700; letter-spacing: 1.5px;
  }
  .process-line { flex-grow: 1; height: 1px; background: linear-gradient(to right, rgba(240, 215, 152, 0.3), transparent); }

  .sidebar-footer { position: relative; z-index: 1; padding-top: 0; display: flex; flex-direction: column; gap: 12px; }

  .btn {
    width: 100%; padding: 13px 15px; border-radius: 10px; font-size: 14px; 
    cursor: pointer; border: none; display: flex; justify-content: space-between; align-items: center;
    transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); position: relative; overflow: hidden;
    font-family: 'Pretendard', sans-serif; font-weight: 700; color: white; 
    text-shadow: 0 1px 2px rgba(0,0,0,0.5); letter-spacing: -0.2px; text-decoration: none; z-index: 50; 
  }
  .btn:active { transform: scale(0.98); }
  .btn > * { pointer-events: none; }

  .btn.upload-complete { flex-direction: column; align-items: flex-start; gap: 8px; height: auto; padding-bottom: 12px; }
  .btn.upload-complete .file-badge-area { width: 100%; justify-content: space-between; background: rgba(30, 41, 59, 0.8); border: 1px solid var(--accent); color: var(--accent); }
  .btn-reset-icon { pointer-events: auto !important; }

  .btn-glass {
    background: rgba(255, 255, 255, 0.08); border: 1px solid rgba(255, 255, 255, 0.15); 
    box-shadow: 0 4px 6px rgba(0,0,0,0.1); backdrop-filter: blur(5px);
  }
  .btn-glass:hover { 
    background: rgba(255, 255, 255, 0.18); border-color: rgba(255, 255, 255, 0.5); color: white; transform: translateY(-2px); 
  }
  .btn-glass.drag-over { background: rgba(240, 215, 152, 0.2); border-color: var(--accent); }

  .step-label {
    font-family: inherit; color: #2d1a04; font-weight: 800; margin-right: 10px; letter-spacing: 0.5px; font-size: 10px; 
    background: var(--accent); padding: 3px 7px; border-radius: 5px; min-width: 50px; text-align: center; display: inline-block;
  }
  
  .btn span:first-child { display: flex; align-items: center; }

  .file-badge-area, .copy-badge-area {
    display: flex; align-items: center; gap: 5px; background: rgba(0,0,0,0.5); padding: 3px 8px; 
    border-radius: 5px; border: 1px solid rgba(255,255,255,0.15); transition: 0.2s; font-size: 11px; font-weight: 600; color: #cbd5e1; 
  }
  .btn-glass:hover .file-badge-area, .btn-glass:hover .copy-badge-area { background: rgba(0,0,0,0.7); border-color: rgba(255,255,255,0.5); color: white; }

  .btn-reset-icon { display: none; margin-left: 2px; color: #ef4444; font-weight: 900; font-size: 13px; padding: 0 4px; cursor: pointer; }
  .guide-text { font-size: 11px; color: #94a3b8; text-align: center; margin-top: 8px; font-weight: 500; opacity: 0.7; line-height: 1.4; }
  .guide-text strong { color: #e2e8f0; font-weight: 700; }


  /* --- [우측 메인 패널] --- */
  .main-content {
    flex-grow: 1; background-color: var(--main-bg); display: flex; flex-direction: column; position: relative; padding-top: 0;
  }

  /* 박스 여백 설정 */
  .workspace-area {
    flex-grow: 1; position: relative; padding: 30px 45px;
    background: #f8fafc; background: radial-gradient(circle at top left, #ffffff 0%, #f1f5f9 60%, #e2e8f0 100%);
    overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center;
  }

  #sourceView { display: flex; flex-direction: column; max-width: 800px; width: 100%; height: auto; gap: 0; }
  
  .input-label-area {
    display: flex; align-items: center; justify-content: space-between; /* 양끝 정렬 */
    gap: 12px; 
    /* 기본 헤더 배경 */
    background: linear-gradient(170deg, var(--sidebar-bg-start) 0%, #171923 100%);
    color: white;
    padding: 10px 18px; 
    border-radius: 12px 12px 0 0; border: 1px solid #334155; border-bottom: none; 
    width: 100%; 
    margin-left: 0; 
    box-shadow: 0 -4px 15px rgba(0,0,0,0.08); position: relative; z-index: 2;
    transition: background 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); /* 색상 전환 효과 */
  }
  
  .input-label-left { display: flex; align-items: center; gap: 10px; } 

  .input-icon-circle { font-size: 12px; color: #4ade80; line-height: 1; text-shadow: 0 0 10px rgba(74, 222, 128, 0.8); display: flex; align-items: center; animation: pulse 2s infinite; }
  @keyframes pulse { 0% { opacity: 1; } 50% { opacity: 0.5; } 100% { opacity: 1; } }

  .input-label-text { font-size: 16px; font-weight: 700; letter-spacing: -0.2px; color: #f1f5f9; }

  /* [유지] 높이 450px */
  .editor-shell {
    height: 450px; 
    min-height: auto; background: #ffffff; border: 1px solid #e2e8f0; border-radius: 0 12px 12px 12px;
    display: flex; flex-direction: column; overflow: hidden; box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.08); 
    position: relative; z-index: 1;
  }
  
  .editor-header {
    background: #f8fafc; padding: 6px 15px; 
    border-bottom: 1px solid #e2e8f0; display: flex; gap: 10px; align-items: center; flex-wrap: wrap; 
    min-height: 36px;
  }
  
  .header-left-group { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }

  .dots { width: 9px; height: 9px; border-radius: 50%; box-shadow: inset 0 0 2px rgba(0,0,0,0.1); }
  .dot-r { background: #fc8181; } .dot-y { background: #f6ad55; } .dot-g { background: #68d391; }
  
  .filename { font-size: 13px; color: #64748b; font-weight: 700; font-family: 'Consolas', monospace; }

  /* [수정] 초기화 버튼: 컴팩트하고 자연스러운 원형 아이콘 */
  .code-clear-btn {
    background: rgba(255, 255, 255, 0.1); 
    border: 1px solid rgba(255, 255, 255, 0.15);
    border-radius: 6px; 
    width: 26px; height: 26px; /* 크기 최적화 (32px -> 26px) */
    display: inline-flex; align-items: center; justify-content: center;
    cursor: pointer; color: #cbd5e1;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  /* 마우스 오버 시 스타일 및 회전 */
  .code-clear-btn:hover { 
    background: rgba(255, 255, 255, 0.25); 
    border-color: rgba(255, 255, 255, 0.4); 
    color: #ffffff; 
    transform: rotate(180deg); /* 자연스러운 회전 */
  }
  
  /* 아이콘 SVG 설정 (선 두께와 크기 조정) */
  .code-clear-btn svg { 
    width: 14px; height: 14px; 
    fill: none; stroke: currentColor; stroke-width: 2.5; stroke-linecap: round; stroke-linejoin: round; 
  }
  
  .paste-guide {
    margin-left: auto; font-size: 11px; color: #64748b; font-weight: 600;
    display: flex; align-items: center; gap: 5px; background: #e2e8f0; padding: 3px 8px; 
    border-radius: 5px; border: 1px solid #cbd5e1;
  }
  
  .code-copy-text {
    display: inline-flex; align-items: center; gap: 2px; background: #cbd5e1; padding: 1px 5px;
    border-radius: 3px; margin: 0 2px; color: #334155; font-family: monospace; font-weight: 700;
  }

  .copy-icon-svg { width: 10px; height: 10px; fill: currentColor; }

  textarea.code-input {
    flex-grow: 1; border: none; padding: 25px; 
    font-family: 'Consolas', 'Monaco', 'D2Coding', monospace; font-size: 14px; 
    color: #334155; resize: none; line-height: 1.6; background: #ffffff; 
    box-shadow: inset 0 0 20px rgba(0,0,0,0.02); caret-color: #3b82f6; 
  }
  
  .btn-execute {
    margin-top: 10px; 
    background: linear-gradient(170deg, var(--sidebar-bg-start) 0%, #171923 100%);
    color: white;
    width: 100%; padding: 12px; 
    border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer;
    box-shadow: 0 10px 20px rgba(30, 41, 59, 0.2); display: flex; justify-content: center; align-items: center; gap: 10px;
    transition: all 0.2s;
    transition: background 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); /* 색상 전환 효과 */
  }
  .btn-execute:hover { transform: translateY(-2px); box-shadow: 0 15px 30px rgba(30, 41, 59, 0.35); }

  #editorView { display: none; width: 100%; max-width: 850px; height: 600px; background: white; border-radius: 12px; border: 1px solid var(--border); overflow-y: auto; padding: 50px; }
  #editorContent { width: 100%; min-height: 100%; outline: none; }

  @keyframes fadeScale { from { opacity: 0; transform: scale(0.98) translateY(10px); } to { opacity: 1; transform: scale(1) translateY(0); } }

  @media (max-width: 1100px) {
    body { display: block; padding: 20px; height: auto; overflow-y: auto; }
    .app-window { width: 100%; height: auto !important; min-height: auto !important; max-height: none !important; flex-direction: column; display: block; overflow: visible; }
    .sidebar { width: 100%; padding: 30px 30px 20px 30px; height: auto !important; min-height: auto !important; flex: none !important; display: block; }
    .workspace-area { padding: 30px; height: auto; min-height: 400px; display: block; background: #f8fafc; }
    #sourceView { margin-top: 20px; }
    .editor-header { flex-direction: column; align-items: flex-start; height: auto; padding: 10px 15px; gap: 8px; }
    .header-left-group { margin-bottom: 2px; }
    .paste-guide { margin-left: 0; width: 100%; justify-content: center; background: #f1f5f9; padding: 6px; }
    .editor-shell { height: 280px; } /* 모바일에서는 더 작게 */
  }
/* ================================================= */
  /* [1. 노트북 전용: 80% 축소 모드] */
  /* 수정: 높이 기준을 1000px -> 880px로 낮춤 (듀얼모니터 오작동 방지) */
  /* ================================================= */
  @media screen and (max-height: 880px) and (min-width: 1100px) {
    body {
      overflow: hidden !important;
      height: 100vh !important;
      display: flex !important;
      align-items: center !important;
      justify-content: center !important;
      background-color: #eef2f6 !important;
    }
    .app-window {
      transform: scale(0.8) !important; /* 노트북만 0.8배 (20% 축소) */
      transform-origin: center center !important;
      
      width: 1380px !important;
      height: 850px !important;
      max-height: none !important;
      margin: 0 !important;
      box-shadow: 0 20px 50px rgba(0,0,0,0.3) !important;
    }
  }

  /* ================================================= */
  /* [2. 모바일/태블릿 전용 모드] */
  /* -> 기존과 동일 (터치 스크롤 허용) */
  /* ================================================= */
  @media screen and (max-width: 1099px) {
    body {
      overflow-y: auto !important;
      height: auto !important;
      transform: none !important;
      display: block !important;
      padding: 15px !important;
    }
    .app-window {
      transform: none !important;
      width: 100% !important;
      height: auto !important;
      max-height: none !important;
      margin: 0 auto !important;
      overflow: visible !important;
    }
    .sidebar {
      height: auto !important;
      padding: 30px 20px !important;
    }
    .brand h1 { font-size: 20px !important; }
  }
  /* [설명서 글씨 연하게 만들기] */
  .code-input::placeholder {
    color: #94a3b8 !important;
    opacity: 0.7 !important;
    font-weight: 390 !important;
  }
</style>
</head>
<body>

  <div class="app-window">
    
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <h1>
          <span id="mainTitle">AI 회의록 변환기</span> 
          <div class="mode-switch-container" id="modeSwitch" onclick="toggleMode()">
            <div class="mode-switch-slider"></div>
            <div class="mode-labels">
              <span class="mode-label-text active" id="labelMeeting">회의</span>
              <span class="mode-label-text" id="labelTrip">출장</span>
            </div>
          </div>
        </h1>
        <p>엔터프라이즈 문서 자동화 솔루션</p>
      </div>

      <div class="input-scroll-area">
        <div class="form-group">
          <label class="label">
            <span id="lbl_title">회의 주제 (PROJECT)</span>
            <button class="clear-btn" tabindex="-1" onclick="clearField('info_title')">지우기</button>
          </label>
          <textarea id="info_title" class="input-field" rows="1" placeholder="기술미팅"></textarea>
        </div>
        <div class="form-group">
          <label class="label">
             <span id="lbl_date">일시 (DATE & TIME)</span>
            <button class="clear-btn" tabindex="-1" onclick="clearField('info_date')">지우기</button>
          </label>
          <textarea id="info_date" class="input-field" rows="1" placeholder="26/1/24 14:00"></textarea>
        </div>
        <div class="form-group">
          <label class="label">
             <span id="lbl_purpose">핵심 목적 (OBJECTIVE)</span>
            <button class="clear-btn" tabindex="-1" onclick="clearField('info_purpose')">지우기</button>
          </label>
          <textarea id="info_purpose" class="input-field" rows="1" placeholder="회의의 목적을 입력하세요"></textarea>
        </div>
        <div class="form-group">
          <label class="label">
             <span id="lbl_room">회의 장소 (LOCATION)</span>
            <button class="clear-btn" tabindex="-1" onclick="clearField('info_room')">지우기</button>
          </label>
          <textarea id="info_room" class="input-field" rows="1" placeholder="본관 대회의실"></textarea>
        </div>
        <div class="form-group">
          <label class="label">
             <span id="lbl_attendees">참석자 명단 (ATTENDEES)</span>
            <button class="clear-btn" tabindex="-1" onclick="clearField('info_attendees')">지우기</button>
          </label>
          <textarea id="info_attendees" class="input-field" rows="1" placeholder="김팀장, 이과장, 박대리..."></textarea>
        </div>
      </div>

      <div class="process-divider">
        <span>EXECUTION FLOW</span>
        <div class="process-line"></div>
      </div>

      <div class="sidebar-footer">
        <input type="file" id="uploadFile" accept=".txt" style="display: none;" onchange="handleFileUpload(this.files[0])">
        <button class="btn btn-glass" id="uploadBtn" onclick="document.getElementById('uploadFile').click()">
          <span><span class="step-label">STEP 1</span><span id="txt_step1">회의록 업로드 (.txt)</span></span>
          <div class="file-badge-area">
             <span style="font-size:12px;">📂</span>
             <span id="fileName" style="font-size:12px;">선택/드래그</span>
             <span id="resetFileBtn" class="btn-reset-icon" onclick="resetFile(event)">✕</span>
          </div>
        </button>

        <button class="btn btn-glass" onclick="copyPrompt()">
          <span><span class="step-label">STEP 2</span>프롬프트 복사</span>
          <div class="copy-badge-area">
             <svg class="copy-icon-svg" viewBox="0 0 24 24"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>
             <span style="font-size:12px;">복사하기</span>
          </div>
        </button>

        <a href="https://gemini.google.com/app" target="_blank" class="btn btn-glass" style="text-decoration:none;">
          <span><span class="step-label">STEP 3</span>제미나이 실행</span>
          <div class="copy-badge-area" style="border:none; background:transparent;">
             <span style="font-size:12px;">열기 ↗</span>
          </div>
        </a>
        
        <div class="guide-text">
          💡 <strong>Tip.</strong> 로그인 후 <strong>Gemini Pro(유료 할당량)</strong> 모드로 실행하세요.<br>
          보안이 중요하다면 <strong>[앱 활동]</strong>을 끄고 사용하세요.
        </div>
      </div>
    </aside>

    <main class="main-content">
      
      <div class="workspace-area">
        
        <div id="sourceView">
          
          <div class="input-label-area" id="rightHeader">
             <div class="input-label-left">
                <span class="input-icon-circle">●</span>
                <span class="input-label-text">제미나이 결과 코드 입력</span>
             </div>
             <button class="code-clear-btn" onclick="clearInputCode()" title="입력 내용 지우기">
               <svg viewBox="0 0 24 24"><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"></path><path d="M21 3v5h-5"></path></svg>
             </button>
          </div>

          <div class="editor-shell">
            <div class="editor-header">
              <div class="header-left-group">
                  <div class="dots dot-r"></div><div class="dots dot-y"></div><div class="dots dot-g"></div>
                  <span class="filename">source_code.html</span>
              </div>
              
              <span class="paste-guide">
                👉 제미나이 답변
                <span class="code-copy-text">[코드복사<svg class="copy-icon-svg" viewBox="0 0 24 24" style="margin-left:2px;"><path d="M16 1H4c-1.1 0-2 .9-2 2v14h2V3h12V1zm3 4H8c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h11c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 16H8V7h11v14z"/></svg>]</span>
                붙여넣기
              </span>
            </div>
            
            <textarea id="inputCode" class="code-input" placeholder="// 잠깐! 방금 복사한 '프롬프트'를 여기에 넣지 마세요!
  ※ 꼭 제미나이에서 답변받은 걸 붙여넣어야 합니다

[ 사용 순서 ]
1. 준비 (Input)
   - 좌측 정보 입력 & .txt 업로드
   (Tip. 네이버 '클로바노트' 변환 파일 추천)
   - [Step 2] 프롬프트 복사 버튼 클릭 
2. 변환 (Gemini)
   - [Step 3] 버튼을 눌러 제미나이 사이트로 이동 후 입력창에 붙여넣기(Ctrl+V) 
   - 제미나이 답변이 나오면(약 30초) 우측 상단 '코드 복사' 클릭
3. 출력 (output)
   - '제미나이에서 출력된 코드'를 여기에 붙여넣으세요.
   (※좌측 프롬프트를 넣으면 변환되지 않습니다)
                
※보안필수: 제미나이 로그인 후 좌측 하단 [활동] → 활동기록 보관 [사용 중지] 필수"></textarea>
          </div>
          
          <button class="btn-execute" id="btnExecute" onclick="executeConversion()">
            <span id="btnExecuteText">▶ 회의록 문서 생성하기 (START)</span>
          </button>
        </div>

        <div id="editorView">
          <div id="editorContent"></div>
        </div>

      </div>
    </main>

  </div>

<textarea id="masterPrompt" style="display:none;">
**[시스템 설정: 수석 프로젝트 매니저 서기 & HTML 코더]**

당신은 30년 경력의 수석 프로젝트 매니저인 서기입니다. 어떤 직종이나 환경의 회의 내용이라도 맥락을 완벽히 파악하여 처리합니다.
제공된 **녹음 텍스트**를 분석하여 **HTML 회의록**을 작성해야 합니다.


"회의록은 회의목적과 맞게 내용 구성될 것"

**⚡ [출력 형식 초강력 통제 (CRITICAL)]**
1. **단일 코드 블록 사용:** 답변의 시작부터 끝까지 오직 **단 하나의 코드 블록(Code Block)** 안에 담아서 출력하십시오. 설명이나 서론/결론을 코드 블록 밖에 적지 마십시오.
2. **언어 설정 'txt' 강제:** 코드 블록 시작 시 언어 태그를 반드시 **`txt`** 또는 **`text`**로 지정하십시오. (예: ```txt ... ```)
   - **경고:** 절대 ```html 이라고 쓰지 마십시오. (색상/하이라이팅 제거 목적)
3. **입력 데이터 검증:** [입력 정보]의 항목이 비어있을 경우, 빈 상태 그대로 출력하십시오.
4. **전체 출력:** <!DOCTYPE html> 부터 </html> 까지 끊김 없이 한 번에 출력하십시오.
5.  **출력 시작:** 반드시 `<!DOCTYPE html>` 로 시작해야 합니다. (```txt 금지)
6.  **출력 종료:** 반드시 `</html>` 로 끝나야 합니다.(```금지)
7.  **메타데이터 강제 적용 (SUPER CRITICAL):** 아래 [입력 정보]에 제공된 1~5번 항목(회의명, 일시, 목적, 회의실, 참석자)의 내용은 **AI가 임의로 해석하거나 변경하지 말고**, **입력된 텍스트 그대로** HTML의 상단 테이블에 채워 넣어야 합니다. (예: 일시에 '점심시간'이라고 적혀있다면 날짜로 바꾸지 말고 '점심시간' 그대로 출력)



**🚫 [포맷팅 절대 원칙 (Formatting Rules)]**
1.  **Markdown 문법 사용 금지:** 본문 내용에 `**텍스트**` 와 같은 마크다운 볼드체 기호를 **절대 사용하지 마십시오.**
2.  **HTML 태그 사용:** 강조가 필요한 단어는 반드시 **`<strong>강조할 내용</strong>`** 태그를 사용하십시오.

[가시성 및 구조화 로직 (Visual Logic)]

1. 단순 나열 금지: 하이픈(-)만 10줄 이상 나열되는 것을 금지합니다. 내용이 많을 경우, 반드시 관련된 3~4개 항목을 묶어 새로운 소주제(■)로 분리하십시오.

**📝 [작성 및 내용 원칙 (요약 시 시스템 실패 간주)]**

1. 회의록은 가능한 같은 주제로 묶어서 작성하며 회의명에 부합하는 주제를 핵심으로 삼도록합니다. 회의록에 텍스트파일에 기록된 가능한 많은 핵심들을 주제에 담아 분류후 원칙에 맞게 작성합니다.
2. 중복 제거 및 팩트 보존: 반복되는 질의응답이나 추임새는 과감히 삭제하되, 언급된 모든 수치(%, kg, 원), 고유명사, 날짜, 설비명은 절대 생략하지 말고 포함해야 합니다.
3. 결과 중심 서술: "논의를 했다"는 과정보다 **"무엇이 결정되었는지", "어떤 이슈가 남았는지"**를 문장의 주성분으로 배치하십시오.
4. 비즈니스 개조식: 문장은 간결한 명사형(~함, ~음, ~임)으로 종결하며, 수식어(매우, 상당히 등)를 제거하여 문장 길이를 단축하십시오.
5.  **디자인 엄수:** 제공된 HTML/CSS 스타일을 임의로 변경하지 마십시오.
6.  **참석자 명기:** 입력된 정보의 실명/직급만 기재하십시오.

**🧹 [텍스트 클리닝]**
* `[cite]`, `[source]`, 타임스탬프(`13:32`) 삭제.
* **영문 제어 원칙:** 해당 산업 및 직무의 **필수 전문 용어는 영문을 유지**하되, 그 외 맥락 없는 일반 영단어나 불필요한 영문 설명은 **삭제하거나 한글로 표기**하십시오.
** `[cite]`, `[source]`, 타임스탬프(`13:32`), 불필요한 영문(`(Coating Prep)`) 삭제.
* **HTML 코드 내에 `cite` 관련 텍스트가 단 하나도 남지 않도록 검수하십시오.**


**🧠 [작성 로직]**
* **1단계: 용어 및 분류**
    * **용어 보정:** 해당 산업/직무의 맥락에 맞춰 오타나 구어체 전문 용어를 **표준 전문 용어**로 보정하십시오.
* **2단계: 기호 및 정렬 (Hierarchy & Layout)**
    * **1. 섹션 헤더 (최상위 그룹핑):** * 1단계에서 분류한 카테고리(결정사항, 이슈 등)는 반드시 순서대로 숫자와 함께(ex. 1.~) `<div class="section-title">카테고리명</div>` 태그로 감싸서 출력하십시오.
        * 이 태그가 있어야 밑줄과 굵은 글씨로 "예쁘게 그룹핑" 됩니다. (절대 생략 금지)
    * **2. 대분류 (■):** * 섹션 헤더 아래에 위치하며, `<li>` 태그 내에 **특수문자 '■ '를 직접 입력**하여 시작하십시오.
    * **3. 소분류 (필수 기호):** 대분류 아래의 **모든 세부 내용(본문)은 반드시 기호로 시작**해야 합니다.
     * **단순 나열:** 반드시 **하이픈(- )**으로 시작하십시오. (예: <li>- 내용</li>)
     * **순서/절차:** 순위나 흐름이 중요할 땐 **원문자(①, ②)**를 사용하십시오.
     * **[주의]** 원문자(①) 앞에는 절대 하이픈(-)을 붙이지 마십시오. 둘 중 하나만 선택하십시오.
    * **엄격한 구조:** `■ 제목` 바로 다음 줄에 `-`나 `①` 없이 글자가 바로 나오는 것을 **절대 금지**합니다.
    * **표 (`<table>`) 활용:** 수치 비교, 복잡한 데이터 정리 (필요시). 표생성시 구분 같이 작은 칸이 필요한 건 조금 작게 내용이 긴 칸은 길게식으로 적절한 열별 너비 확보, 비고와 내용은 구분할것 내용이 위주고 비고는 비고가 필요할 때만 쓸것(회의록 마지막에 배치된 주제에 맞지않은 표일 경우 어떤표인지 설명)

---

**[HTML 템플릿 코드 (이 코드를 기반으로 내용만 채워서 출력할 것)]**

<!DOCTYPE html>
<html lang="ko">
<head><meta charset="UTF-8"><title>회의록</title>
<style>
/* [폰트 추가] Noto Sans KR 웹폰트 임포트 (가독성 확보) */
@import url('[https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&display=swap](https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&display=swap)');

/* 기본 설정 */
body{font-family:'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif; margin:0;padding:30px;background-color:#f2f2f2;}

/* 전체 너비 1170px (와이드) 유지 */
.container{max-width:1170px;margin:0 auto;border:1px solid #d1d1d1;padding:50px;background:#fff;box-shadow:0 4px 20px rgba(0,0,0,0.08);}

/* 헤더: 로고와 선 간격 밀착 */
.doc-header{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:0px;}

/* 제목 폰트: 'Noto Sans KR' 적용 */
.doc-title{font-family:'Noto Sans KR', 'Malgun Gothic', sans-serif; font-size:32px;font-weight:700;color:#111;margin:0;line-height:1.2;letter-spacing:0px;flex:1;margin-bottom:12px;}

/* 로고 크기 38px 유지 */
.hansol-logo{font-family:Arial,sans-serif;font-weight:900;font-size:38px;color:#5e5e5e;display:flex;align-items:center;letter-spacing:-1.5px;position:relative;top:3px;white-space:nowrap;}
.logo-dots{display:flex;flex-direction:column;justify-content:space-between;height:28px;margin-right:7px;margin-top:3px;}
.dot{width:11px;height:11px;display:block;border-radius:0;}
.dot.blue{background-color:#1a3c6e;}.dot.green{background-color:#e3c06b;}

/* 회색 그라데이션 유지 */
/* [절대 수정 금지] 회색 그라데이션 고정 강제 적용 */
.header-bar{width:100%;height:9px;border:none;margin-bottom:30px;background:linear-gradient(to right,#5e5e5e 0%,#5e5e5e 25%,#b0b0b0 25%,#b0b0b0 100%) !important; -webkit-print-color-adjust: exact;}

/* 테이블: 테두리 충돌 해결 (수정 기능이 켜져도 테두리는 유지되도록 !important 적용) */
table{width:100%;border-collapse:collapse !important;font-size:15px;text-align:center;margin-bottom:40px;table-layout:fixed; border:1px solid #aaa !important;}
th, td{border:1px solid #aaa !important; padding:7px 10px;vertical-align:middle;height:30px;word-break:break-all;color:#222;}
.label{background-color:#f9f9f9;font-weight:bold;color:#111;letter-spacing:-0.5px;}
.content-cell{text-align:left;padding-left:15px;font-weight:500;}

/* 본문 박스 스타일 (수정 기능 켜져도 외곽선 유지되도록 !important 적용) */
.body-header{background-color:#f9f9f9;text-align:center;padding:12px;font-weight:bold;border:1px solid #d1d1d1 !important;border-bottom:1px solid #eee !important;margin-bottom:0;font-size:18px;letter-spacing:4px;color:#333;border-radius:4px 4px 0 0;}
.content-body{border:1px solid #d1d1d1 !important;border-top:none !important;padding:35px;line-height:2.1;letter-spacing:-0.4px;min-height:450px;color:#222;border-radius:0 0 4px 4px;word-break:keep-all;}

/* 계층 정렬 로직 */
.section-title{font-weight:800;font-size:20px;color:#000;margin-bottom:20px;margin-top:35px;display:block;border-bottom:2px solid #eee;padding-bottom:10px;}
.content-body .section-title:first-child { margin-top: 0; }

/* 대분류 (■) - 수정됨: 자동생성 제거, 들여쓰기 제거 */
ul.main-list { list-style: none; padding-left: 0; margin-top: 10px; }
li.main-item { font-size: 18px; margin-bottom: 20px; padding-left: 0; text-indent: 0; font-weight: bold; color: #111; list-style: none; }

/* 소분류 (①, -) - 수정됨: 들여쓰기 축소, 줄간격 확대 */
ul.sub-list { list-style: none; padding-left: 4px; margin-top: 16px; font-weight: normal; color: #333; }
li.sub-item { font-size: 16px; margin-bottom: 8px; padding-left: 5px; text-indent: -5px; line-height: 1.8; }

/* 본문 내 표 스타일 */
.content-table { width: 100%; border-collapse: collapse !important; margin-top: 15px; margin-bottom: 25px; font-size: 14px; border: 1px solid #ccc !important; }
.content-table th { background-color: #f2f2f2; border: 1px solid #ccc !important; padding: 8px; font-weight: bold; text-align: center; color: #333; }
.content-table td { border: 1px solid #ccc !important; padding: 8px; text-align: center; color: #444; }

/* [수정 기능] CSS 수정: 'border: none' 삭제 -> 'outline: none'만 유지 */
[contenteditable] { outline: none !important; box-shadow: none !important; cursor: text; }

/* [수정] 볼드체: 진한 회색(#333) 적용 */
strong{font-weight:800;color:#333;}
cite, .cite, [data-source], span[class*="cite"] { display: none !important; opacity: 0 !important; font-size: 0 !important; width:0; height:0; overflow:hidden; }

/* [인쇄 설정] 파일경로 및 날짜 제거 (여백 유지) */
@media print {
    @page { 
        margin: 0; /* 브라우저 기본 헤더/푸터(날짜, 경로) 숨김 처리 */
        size: A4; 
    }
    body {
        margin: 0; 
        padding: 15mm; /* 제거된 여백만큼 내부 패딩을 주어 시각적 여백 유지 */
        background: #fff;
        zoom: 0.6; /* 200% 확대 방지 및 A4 정비율 축소 */
    }
    .container {
        width: 1170px !important; max-width: 1170px !important;
        margin: 0 auto; 
        border: none; box-shadow: none;
    }
    * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
}
</style>
</head>
<body>
<div class="container">
    <div class="doc-header">
        <h1 class="doc-title">[회의록] <span id="title" contenteditable="true">{회의명}</span></h1>
        <div class="hansol-logo"><div class="logo-dots"><span class="dot blue"></span><span class="dot green"></span></div>REPORT</div>
    </div>
    <div class="header-bar"></div>
    <table>
        <colgroup><col style="width:130px;"><col><col style="width:130px;"><col style="width:380px;"></colgroup>
        <tr>
            <td class="label">일    시</td><td class="content-cell" contenteditable="true">{일시}</td><td class="label">장    소</td><td class="content-cell" contenteditable="true">{회의실}</td>
        </tr>
        <tr>
            <td class="label">참석자</td><td class="content-cell" contenteditable="true">{참석자}</td><td class="label">목    적</td><td class="content-cell" contenteditable="true">{목적}</td>
        </tr>
        <tr>
            <td class="label">회의명</td><td colspan="3" class="content-cell" contenteditable="true">{회의명}</td>
        </tr>
    </table>
    <div class="body-header">내        용</div>
    <div class="content-body" contenteditable="true">
        {분석된 내용}
    </div>
</div>
</body>
</html>

**[입력 정보]** (▼ 아래 내용을 모두 채워주세요. 1~5번 누락 시 작성되지 않습니다.)

**1. 회의명(회의제목) : {INPUT_TITLE}
**2. 일  시 : {INPUT_DATE}
**3. 목  적 : {INPUT_PURPOSE}
**4. 회의실 : {INPUT_ROOM}
**5. 참석자 : {INPUT_ATTENDEES}
</textarea>

<textarea id="tripPrompt" style="display:none;">
**[시스템 설정: Global Strategy Consultant (냉철한 분석가 페르소나)]**

당신은 기업의 수석 전략가입니다. 제공된 **[녹음 텍스트]**를 분석하여 의사결정권자를 위한 **S급 출장보고서**를 작성하십시오.
녹음 내용은 횡설수설하거나 비문이 많으므로, 이를 그대로 옮기지 말고 **"가치(Value)와 팩트(Fact)"** 중심으로 재구성해야 합니다.

**⚡ [출력 형식 초강력 통제 (CRITICAL)]**
1. **단일 코드 블록 사용:** 답변의 시작부터 끝까지 오직 **단 하나의 코드 블록(Code Block)** 안에 담아서 출력하십시오. 설명이나 서론/결론을 코드 블록 밖에 적지 마십시오.
2. **언어 설정 'txt' 강제:** 코드 블록 시작 시 언어 태그를 반드시 **`txt`** 또는 **`text`**로 지정하십시오. (예: ```txt ... ```)
   - **경고:** 절대 ```html 이라고 쓰지 마십시오. (색상/하이라이팅 제거 목적)
3. **입력 데이터 검증:** [입력 정보]의 항목이 비어있을 경우, 빈 상태 그대로 출력하십시오.
4. **전체 출력:** <!DOCTYPE html> 부터 </html> 까지 끊김 없이 한 번에 출력하십시오.
5.  **출력 시작:** 반드시 `<!DOCTYPE html>` 로 시작해야 합니다. (```txt 금지)
6.  **출력 종료:** 반드시 `</html>` 로 끝나야 합니다.(```금지)
7.  **메타데이터 강제 적용 (SUPER CRITICAL):** 아래 [입력 정보]에 제공된 1~5번 항목(출장 내용, 출장 일정, 핵심 안건, 출장 장소, 관련인원)의 내용은 **AI가 임의로 해석하거나 변경하지 말고**, **입력된 텍스트 그대로** HTML의 상단 테이블에 채워 넣어야 합니다. (예: 일시에 '점심시간'이라고 적혀있다면 날짜로 바꾸지 말고 '점심시간' 그대로 출력)

**🚫 [포맷팅 절대 원칙 (Formatting Rules)]**
1.  **Markdown 문법 사용 금지:** 본문 내용에 `**텍스트**` 와 같은 마크다운 볼드체 기호를 **절대 사용하지 마십시오.**
2.  **HTML 태그 사용:** 강조가 필요한 단어는 반드시 **`<strong>강조할 내용</strong>`** 태그를 사용하십시오.

[가시성 및 구조화 로직 (Visual Logic)]

1. 단순 나열 금지: 하이픈(-)만 10줄 이상 나열되는 것을 금지합니다. 내용이 많을 경우, 반드시 관련된 3~4개 항목을 묶어 새로운 소주제(■)로 분리하십시오.

**🎯 [S급 논리 구조: 5-Step Framework]**
보고서는 다음 5개의 섹션 헤더를 기준으로 작성되어야 합니다.
1. **요약 (Executive Summary):** 전체 내용을 관통하는 '성패 여부'와 'ROI(성과)'를 3줄로 압축. ((※이 섹션은 ■ 기호를 절대 쓰지 말고, 반드시 하이픈(-)으로만 작성할 것)
2. **주요 의사결정 (Key Decisions):** 모호한 표현을 배제하고 '확정된 숫자/계약/합의'만 명시.
3. **현장 및 품질 분석 (Insights):** 대화 속에서 감지된 '경쟁사 동향', '고객의 진짜 속마음(우려)', '시장 분위기'. (내용에 따라 헤더 수정 가능)
4. **잠재 리스크 및 미결 (Risks & Pending):** 해결되지 않은 숙제(Pending)와 잠재적 위험 요소(Risk)를 별도 분리. (내용에 따라 헤더 수정 가능)
5. **실행 계획 (Action Plan):** 누가, 언제까지, 무엇을 할 것인지 명확한 To-Do.

**📝 [작성 및 내용 원칙 (요약 시 시스템 실패 간주)]**

1.  **냉철한 개조식:** "~했습니다" (X) → "~확인함", "~로 결정됨" (O) 문장은 간결한 명사형으로 종결하십시오.
2.  **할루시네이션 방지:** 녹음 내용에 없는 날짜나 금액은 절대 창조하지 말고 '미정' 또는 '확인 필요'로 적으시오.
3.  **팩트 보존:** 반복되는 질의응답이나 추임새는 과감히 삭제하되, 언급된 모든 수치(%, kg, 원), 고유명사, 날짜, 설비명은 절대 생략하지 말고 포함해야 합니다.
4.  **디자인 엄수:** 제공된 HTML/CSS 스타일을 임의로 변경하지 마십시오. (회의록과 100% 동일한 한솔 스타일 유지 필수)
5.  **참석자 명기:** 입력된 정보의 실명/직급만 기재하십시오.

**🧹 [텍스트 클리닝]**
* `[cite]`, `[source]`, 타임스탬프(`13:32`) 삭제.
* **영문 제어 원칙:** 해당 산업 및 직무의 **필수 전문 용어는 영문을 유지**하되, 그 외 맥락 없는 일반 영단어나 불필요한 영문 설명은 **삭제하거나 한글로 표기**하십시오.
** `[cite]`, `[source]`, 타임스탬프(`13:32`), 불필요한 영문 삭제.
* **HTML 코드 내에 `cite` 관련 텍스트가 단 하나도 남지 않도록 검수하십시오.**


**🧠 [작성 로직]**
* **1단계 : 용어 및 분류**
    * **용어 보정:** 해당 산업/직무의 맥락에 맞춰 오타나 구어체 전문 용어를 **표준 전문 용어**로 보정하십시오.
* **2단계 : 계층 구조 (Hierarchy & Layout)**
    * **1. 섹션 헤더 (최상위 그룹핑):** 위에서 정의한 5-Step Framework(요약, 주요 의사결정 등)의 제목은 반드시 순서대로 숫자와 함께(ex. 1.~) `<div class="section-title">카테고리명</div>` 태그로 감싸서 출력하십시오.
    * **2. 대분류 (■):** 섹션 헤더 아래에 위치하며, `<li>` 태그 내에 **특수문자 '■ '를 직접 입력**하여 시작하십시오. (출장의 방향성 표현)
    * **3. 소분류 (필수 기호):** 대분류 아래의 **모든 세부 내용(본문)은 반드시 기호로 시작**해야 합니다.
        * **단순 나열:** 반드시 **하이픈(- )**으로 시작하십시오. (예: <li>- 내용</li>)
        * **순서/절차:** 순위나 흐름이 중요할 땐 **원문자(①, ②)**를 사용하십시오.
    * **표 (`<table>`) 활용:** 수치 비교, 복잡한 데이터 정리 (필요시).
    * **엄격한 구조:** `■ 제목` 바로 다음 줄에 `-`나 `①` 없이 글자가 바로 나오는 것을 **절대 금지**합니다.
    * **표 (`<table>`) 활용:** 수치 비교, 복잡한 데이터 정리 (필요시). 표생성시 구분 같이 작은 칸이 필요한 건 조금 작게 내용이 긴 칸은 길게식으로 적절한 열별 너비 확보, 비고와 내용은 구분할것 내용이 위주고 비고는 비고가 필요할 때만 쓸것(회의록 마지막에 배치된 주제에 맞지않은 표일 경우 어떤표인지 설명)

---

**[HTML 템플릿 코드 (이 코드를 기반으로 내용만 채워서 출력할 것)]**

<!DOCTYPE html>
<html lang="ko">
<head><meta charset="UTF-8"><title>출장보고서</title>
<style>
/* [폰트 추가] Noto Sans KR 웹폰트 임포트 (가독성 확보) */
@import url('[https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&display=swap](https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@700&display=swap)');

/* 기본 설정 */
body{font-family:'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif; margin:0;padding:30px;background-color:#f2f2f2;}

/* 전체 너비 1170px (와이드) 유지 */
.container{max-width:1170px;margin:0 auto;border:1px solid #d1d1d1;padding:50px;background:#fff;box-shadow:0 4px 20px rgba(0,0,0,0.08);}

/* 헤더: 로고와 선 간격 밀착 */
.doc-header{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:0px;}

/* 제목 폰트: 'Noto Sans KR' 적용 */
.doc-title{font-family:'Noto Sans KR', 'Malgun Gothic', sans-serif; font-size:32px;font-weight:700;color:#111;margin:0;line-height:1.2;letter-spacing:0px;flex:1;margin-bottom:12px;}

/* 로고 크기 38px 유지 */
.hansol-logo{font-family:Arial,sans-serif;font-weight:900;font-size:38px;color:#5e5e5e;display:flex;align-items:center;letter-spacing:-1.5px;position:relative;top:3px;white-space:nowrap;}
.logo-dots{display:flex;flex-direction:column;justify-content:space-between;height:28px;margin-right:7px;margin-top:3px;}
.dot{width:11px;height:11px;display:block;border-radius:0;}
.dot.blue{background-color:#1a3c6e;}.dot.green{background-color:#e3c06b;}

/* 회색 그라데이션 유지 */
/* [절대 수정 금지] 회색 그라데이션 고정 강제 적용 */
.header-bar{width:100%;height:9px;border:none;margin-bottom:30px;background:linear-gradient(to right,#5e5e5e 0%,#5e5e5e 25%,#b0b0b0 25%,#b0b0b0 100%) !important; -webkit-print-color-adjust: exact;}

/* 테이블: 테두리 충돌 해결 (수정 기능이 켜져도 테두리는 유지되도록 !important 적용) */
table{width:100%;border-collapse:collapse !important;font-size:15px;text-align:center;margin-bottom:40px;table-layout:fixed; border:1px solid #aaa !important;}
th, td{border:1px solid #aaa !important; padding:7px 10px;vertical-align:middle;height:30px;word-break:break-all;color:#222;}
.label{background-color:#f9f9f9;font-weight:bold;color:#111;letter-spacing:-0.5px;}
.content-cell{text-align:left;padding-left:15px;font-weight:500;}

/* 본문 박스 스타일 (수정 기능 켜져도 외곽선 유지되도록 !important 적용) */
.body-header{background-color:#f9f9f9;text-align:center;padding:12px;font-weight:bold;border:1px solid #d1d1d1 !important;border-bottom:1px solid #eee !important;margin-bottom:0;font-size:18px;letter-spacing:4px;color:#333;border-radius:4px 4px 0 0;}
.content-body{border:1px solid #d1d1d1 !important;border-top:none !important;padding:35px;line-height:2.1;letter-spacing:-0.4px;min-height:450px;color:#222;border-radius:0 0 4px 4px;word-break:keep-all;}

/* 계층 정렬 로직 */
.section-title{font-weight:800;font-size:20px;color:#000;margin-bottom:20px;margin-top:35px;display:block;border-bottom:2px solid #eee;padding-bottom:10px;}
.content-body .section-title:first-child { margin-top: 0; }

/* 대분류 (■) - 수정됨: 자동생성 제거, 들여쓰기 제거 */
ul.main-list { list-style: none; padding-left: 0; margin-top: 10px; }
li.main-item { font-size: 18px; margin-bottom: 20px; padding-left: 0; text-indent: 0; font-weight: bold; color: #111; list-style: none; }

/* 소분류 (①, -) - 수정됨: 들여쓰기 축소, 줄간격 확대 */
ul.sub-list { list-style: none; padding-left: 4px; margin-top: 16px; font-weight: normal; color: #333; }
li.sub-item { font-size: 16px; margin-bottom: 8px; padding-left: 5px; text-indent: -5px; line-height: 1.8; }

/* 본문 내 표 스타일 */
.content-table { width: 100%; border-collapse: collapse !important; margin-top: 15px; margin-bottom: 25px; font-size: 14px; border: 1px solid #ccc !important; }
.content-table th { background-color: #f2f2f2; border: 1px solid #ccc !important; padding: 8px; font-weight: bold; text-align: center; color: #333; }
.content-table td { border: 1px solid #ccc !important; padding: 8px; text-align: center; color: #444; }

/* [수정 기능] CSS 수정: 'border: none' 삭제 -> 'outline: none'만 유지 */
[contenteditable] { outline: none !important; box-shadow: none !important; cursor: text; }

/* [수정] 볼드체: 진한 회색(#333) 적용 */
strong{font-weight:800;color:#333;}
cite, .cite, [data-source], span[class*="cite"] { display: none !important; opacity: 0 !important; font-size: 0 !important; width:0; height:0; overflow:hidden; }

/* [인쇄 설정] 파일경로 및 날짜 제거 (여백 유지) */
@media print {
    @page { 
        margin: 0; /* 브라우저 기본 헤더/푸터(날짜, 경로) 숨김 처리 */
        size: A4; 
    }
    body {
        margin: 0; 
        padding: 15mm; /* 제거된 여백만큼 내부 패딩을 주어 시각적 여백 유지 */
        background: #fff;
        zoom: 0.6; /* 200% 확대 방지 및 A4 정비율 축소 */
    }
    .container {
        width: 1170px !important; max-width: 1170px !important;
        margin: 0 auto; 
        border: none; box-shadow: none;
    }
    * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
}
</style>
</head>
<body>
<div class="container">
    <div class="doc-header">
        <h1 class="doc-title">[출장보고서] <span id="title" contenteditable="true">{출장 내용}</span></h1>
        <div class="hansol-logo"><div class="logo-dots"><span class="dot blue"></span><span class="dot green"></span></div>REPORT</div>
    </div>
<div class="header-bar"></div>
    
    <table>
        <colgroup><col style="width:130px;"><col><col style="width:130px;"><col style="width:380px;"></colgroup>
        <tr>
            <td class="label">출장 일정</td><td class="content-cell" contenteditable="true">{출장 일정}</td><td class="label">출장 장소</td><td class="content-cell" contenteditable="true">{출장 장소}</td>
        </tr>
        <tr>
            <td class="label">관련 인원</td><td class="content-cell" contenteditable="true">{관련 인원}</td><td class="label">핵심 안건</td><td class="content-cell" contenteditable="true">{핵심 안건}</td>
        </tr>
        <tr>
            <td class="label">출장 내용</td><td colspan="3" class="content-cell" contenteditable="true">{출장 내용}</td>
        </tr>
    </table>
    <div class="body-header">내        용</div>
    <div class="content-body" contenteditable="true">
        {분석된 내용}
    </div>
</div>
</body>
</html>

**[입력 정보]** (▼ 아래 내용을 모두 채워주세요.)

**1. 출장 내용 : {INPUT_TITLE}
**2. 기  간 : {INPUT_DATE}
**3. 목  적 : {INPUT_PURPOSE}
**4. 출장지 : {INPUT_ROOM}
**5. 출장자 : {INPUT_ATTENDEES}
</textarea>

<script>
  let transcriptContent = "";
  let isTripMode = false; // [수정] 모드 상태 변수

  function setToday() {
    const now = new Date();
    const year = String(now.getFullYear()).slice(-2);
    const month = now.getMonth() + 1; 
    const date = now.getDate();        
    const formatted = `${year}/${month}/${date} `;
    const input = document.getElementById('info_date');
    input.value = formatted;
  }
  
  window.onload = function() { setToday(); };

  // [수정] 모드 전환 기능 (슬라이드 & 텍스트 변경 & 배경색 변경)
  function toggleMode() {
    isTripMode = !isTripMode;
    const sidebar = document.getElementById('sidebar'); // 사이드바
    const rightHeader = document.getElementById('rightHeader'); // 우측 코드 입력창 헤더
    const btnExecute = document.getElementById('btnExecute'); // 실행 버튼
    
    const switchContainer = document.getElementById('modeSwitch');
    const labelMeeting = document.getElementById('labelMeeting');
    const labelTrip = document.getElementById('labelTrip');
    const mainTitle = document.getElementById('mainTitle'); // 메인 제목
    const btnExecuteText = document.getElementById('btnExecuteText'); // 버튼 텍스트

    // UI 상태 토글
    if (isTripMode) {
        // [수정] 3개 영역(사이드바, 우측헤더, 버튼)에 Trip Theme 적용
        sidebar.classList.add('trip-skin');
        rightHeader.classList.add('trip-skin');
        btnExecute.classList.add('trip-skin');
        
        // 스위치 및 라벨
        switchContainer.classList.add('trip-mode');
        labelMeeting.classList.remove('active');
        labelTrip.classList.add('active');

        // [수정] 텍스트 변경
        mainTitle.innerText = "AI 출장보고서 변환기";
        btnExecuteText.innerText = "▶ 출장보고서 생성하기 (START)";

        document.getElementById('lbl_title').innerText = "출장 내용 (TITLE)"; 
        // [수정] placeholder에서 '예: ' 제거
        document.getElementById('info_title').placeholder = "고객사 기술 지원 및 미팅";
        
        document.getElementById('lbl_date').innerText = "출장 일정 (SCHEDULE)";
        // [수정] placeholder에서 '예: ' 제거
        document.getElementById('info_date').placeholder = "26.01.24 ~ 01.26 (2박 3일)";

        document.getElementById('lbl_purpose').innerText = "핵심 안건 (AGENDA)";
        document.getElementById('info_purpose').placeholder = "현장 점검 및 기술 협의";

        document.getElementById('lbl_room').innerText = "출장 장소 (LOCATION)";
        // [수정] placeholder에서 '예: ' 제거
        document.getElementById('info_room').placeholder = "서울 본사, 협력사 공장";

        document.getElementById('lbl_attendees').innerText = "관련 인원 (PARTICIPANTS)";
        document.getElementById('info_attendees').placeholder = "홍길동 팀장, 품질관리팀 등";
        
        document.getElementById('txt_step1').innerText = "출장녹음 업로드(.txt)";

    } else {
        // [수정] Trip Theme 제거
        sidebar.classList.remove('trip-skin');
        rightHeader.classList.remove('trip-skin');
        btnExecute.classList.remove('trip-skin');

        // 스위치 및 라벨
        switchContainer.classList.remove('trip-mode');
        labelTrip.classList.remove('active');
        labelMeeting.classList.add('active');

        // [수정] 텍스트 복구
        mainTitle.innerText = "AI 회의록 변환기";
        btnExecuteText.innerText = "▶ 회의록 문서 생성하기 (START)";

        document.getElementById('lbl_title').innerText = "회의 주제 (PROJECT)";
        // [수정] placeholder에서 '예: ' 제거
        document.getElementById('info_title').placeholder = "기술미팅";
        
        document.getElementById('lbl_date').innerText = "일시 (DATE & TIME)";
        // [수정] placeholder에서 '예: ' 제거
        document.getElementById('info_date').placeholder = "26/1/24 14:00";

        document.getElementById('lbl_purpose').innerText = "핵심 목적 (OBJECTIVE)";
        document.getElementById('info_purpose').placeholder = "회의의 목적을 입력하세요";

        document.getElementById('lbl_room').innerText = "회의 장소 (LOCATION)";
        document.getElementById('info_room').placeholder = "본관 대회의실";

        document.getElementById('lbl_attendees').innerText = "참석자 명단 (ATTENDEES)";
        document.getElementById('info_attendees').placeholder = "김팀장, 이과장, 박대리...";
        
        document.getElementById('txt_step1').innerText = "회의록 업로드 (.txt)";
    }
  }

  function clearField(id) {
    document.getElementById(id).value = ''; document.getElementById(id).focus();
  }

  function handleFileUpload(file) {
    if (!file) return;
    const btn = document.getElementById('uploadBtn');
    btn.classList.add('upload-complete');
    const fileNameSpan = document.getElementById('fileName');
    fileNameSpan.innerHTML = `<b>${file.name}</b> <span style="color:var(--accent); font-size:11px; margin-left:4px;">(준비완료)</span>`;
    document.getElementById('resetFileBtn').style.display = 'block';
    const reader = new FileReader();
    reader.onload = function(e) { transcriptContent = e.target.result; };
    reader.onerror = function() { alert("파일을 읽는 중 오류가 발생했습니다."); };
    reader.readAsText(file);
  }

  function resetFile(event) {
    event.stopPropagation(); 
    const btn = document.getElementById('uploadBtn');
    btn.classList.remove('upload-complete');
    transcriptContent = "";
    document.getElementById('uploadFile').value = ""; 
    document.getElementById('fileName').innerText = "선택/드래그";
    document.getElementById('resetFileBtn').style.display = 'none';
  }

  const uploadBtn = document.getElementById('uploadBtn');
  uploadBtn.addEventListener('dragover', (e) => { e.preventDefault(); uploadBtn.classList.add('drag-over'); });
  uploadBtn.addEventListener('dragleave', (e) => { e.preventDefault(); uploadBtn.classList.remove('drag-over'); });
  uploadBtn.addEventListener('drop', (e) => {
    e.preventDefault(); uploadBtn.classList.remove('drag-over');
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      if(files[0].type === "text/plain" || files[0].name.endsWith(".txt")) { handleFileUpload(files[0]); } 
      else { alert("⚠️ .txt 텍스트 파일만 업로드 가능합니다."); }
    }
  });

  function copyPrompt() {
    // 1. 입력값 가져오기
    const title = document.getElementById('info_title').value.trim();
    const date = document.getElementById('info_date').value.trim();
    const purpose = document.getElementById('info_purpose').value.trim();
    const room = document.getElementById('info_room').value.trim();
    const attendees = document.getElementById('info_attendees').value.trim();

    // 2. 필수 입력값 체크
    if (!title || !date || !purpose || !room || !attendees) { alert("⚠️ [안내] 5가지 필수 입력 항목을 모두 채워주세요."); return; }
    if (!transcriptContent) { alert("⚠️ [안내] 1단계: 텍스트 파일(.txt)을 먼저 업로드해주세요."); return; }

    // 3. 프롬프트 내용 조합
    let promptId = isTripMode ? 'tripPrompt' : 'masterPrompt';
    let fullPrompt = document.getElementById(promptId).value;

    if(isTripMode && !fullPrompt) {
        alert("⚠️ [주의] 출장용 프롬프트 내용이 비어있습니다.\n소스 코드 하단의 textarea id='tripPrompt' 영역에 내용을 채워주세요.");
        return;
    }

    fullPrompt = fullPrompt.replace('{INPUT_TITLE}', title);
    fullPrompt = fullPrompt.replace('{INPUT_DATE}', date);
    fullPrompt = fullPrompt.replace('{INPUT_PURPOSE}', purpose);
    fullPrompt = fullPrompt.replace('{INPUT_ROOM}', room);
    fullPrompt = fullPrompt.replace('{INPUT_ATTENDEES}', attendees);

    const finalContent = fullPrompt + "\n\n--- [입력된 텍스트] ---\n" + transcriptContent;

    // ============================================================
    // [수정된 핵심 로직] 최신 브라우저 & 구형/보안 PC 모두 호환
    // ============================================================
    
    // 1. 최신 방식 시도
    if (navigator.clipboard && window.isSecureContext) {
        navigator.clipboard.writeText(finalContent)
            .then(() => alertSuccess())
            .catch(() => fallbackCopy(finalContent)); // 실패 시 비상용 함수 실행
    } else {
        // 아예 최신 기능이 없는 경우 바로 비상용 함수 실행
        fallbackCopy(finalContent);
    }

    // [성공 메시지 함수]
    function alertSuccess() {
        const modeName = isTripMode ? "출장보고서" : "회의록";
        alert(`✅ [${modeName} 모드] 전체 프롬프트가 복사되었습니다.\nGemini에 바로 붙여넣기(Ctrl+V) 하세요.`);
    }

    // [비상용 강제 복사 함수] (회사컴/구형컴 보험용)
    function fallbackCopy(text) {
        try {
            const textArea = document.createElement("textarea");
            textArea.value = text;
            textArea.style.position = "fixed";
            textArea.style.left = "-9999px"; // 화면 밖으로 숨김
            document.body.appendChild(textArea);
            textArea.focus();
            textArea.select();
            
            const successful = document.execCommand('copy'); // 강제 복사 명령
            document.body.removeChild(textArea);
            
            if (successful) alertSuccess();
            else throw new Error("복사 실패");
        } catch (err) {
            // 최후의 수단: 직접 복사 유도
            window.prompt("⚠️ 보안상 자동 복사가 차단되었습니다. 아래 텍스트를 직접 복사(Ctrl+C)하세요:", text);
        }
    }
  }

  function clearInputCode() {
    if(confirm('입력된 코드를 모두 지우시겠습니까?')) {
        document.getElementById('inputCode').value = '';
        document.getElementById('inputCode').focus();
    }
  }

function executeConversion() {
    const rawInput = document.getElementById('inputCode').value;
    let cleanHtml = rawInput;

    // 1. 제미나이 마크다운(```html ... ```) 제거 로직
    if (cleanHtml.includes("```")) {
      const parts = cleanHtml.split("```");
      for(let part of parts) {
        if(part.toLowerCase().includes("<!doctype html>") || part.toLowerCase().includes("<html")) { 
            cleanHtml = part; break; 
        }
      }
      cleanHtml = cleanHtml.replace(/^html/i, "").replace(/^xml/i, "").replace(/^txt/i, "").trim();
    }

    if(!cleanHtml) { alert("변환할 코드를 입력해주세요."); return; }

const dragFeatureCode = `
      <button onclick="window.print()" class="pdf-save-btn">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="save-icon">
              <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
              <polyline points="17 21 17 13 7 13 7 21"></polyline>
              <polyline points="7 3 7 8 15 8"></polyline>
          </svg>
          <div class="btn-text-group">
              PDF 저장<br>
              <span class="btn-sub-text">※ 인쇄 설정: 'PDF로 저장' 선택</span>
          </div>
      </button>

      <style>
        /* [버튼 스타일: 원본 크기 & 상단 위치 유지] */
        .pdf-save-btn {
            position: fixed; 
            top: 10px;    /* 맨 위 회색 여백 */
            right: 40px;  /* 우측 여백 */
            z-index: 99999; 
            
            background: #1a1a1a; 
            color: white; 
            border: 1px solid rgba(255,255,255,0.2); 
            
            /* 버튼 크기 원본(큼직하게) 유지 */
            padding: 10px 20px 10px 16px; 
            border-radius: 8px; 
            
            font-family: 'Pretendard', sans-serif; 
            cursor: pointer; 
            box-shadow: 0 4px 15px rgba(0,0,0,0.2); 
            display: flex; align-items: center; gap: 12px; 
            text-align: left; line-height: 1.4; transition: all 0.2s ease;
        }

        .pdf-save-btn:hover { background: #333333; transform: translateY(-2px); }
        .save-icon { color: #e2e8f0; flex-shrink: 0; }
        .btn-text-group { display: flex; flex-direction: column; }
        .btn-sub-text { font-size: 11px; opacity: 0.8; letter-spacing: -0.5px; }
        
        /* [기능 보호 구역] */
        @media print { 
            .pdf-save-btn { display: none !important; }
            
            /* ▼▼▼ [추가된 부분] 모바일 PDF 저장 시 '연초록색' 방지 코드 ▼▼▼ */
            /* 인쇄 시 배경색을 표준 회색(#f2f2f2)으로 강력하게 고정합니다 */
            .label, .body-header, th {
                background-color: #f2f2f2 !important; 
                color: #000 !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            /* 본문 셀은 무조건 흰색으로 고정 */
            .content-cell, td {
                background-color: #ffffff !important;
            }
            /* ▲▲▲ [추가 완료] ▲▲▲ */
            
            @page { 
                size: A4; 
                margin: 0mm !important; 
            }
            
            body { 
                margin: 0 !important; 
                padding: 0 !important;
                background: white !important;
                width: 100% !important;
                height: 100% !important; 
                overflow: hidden !important; 
            }
            
            .container { 
                width: 1170px !important; 
                max-width: 1170px !important;
                margin: 0 auto !important; 
                padding: 70px 50px !important; 
                border: none !important; 
                box-shadow: none !important; 
            }
                .content-body {
                border: 1.7px solid #d1d1d1 !important;
                border-top: none !important;
        }
        
        .content-body img { cursor: col-resize; max-width: 100%; min-width: 50px; }
        .resizing { user-select: none; cursor: col-resize !important; }
      </style>
      
      <script>
        /* [기능 보호 구역: 로직 100% 원본 동일] */
        window.addEventListener('beforeprint', function() {
            const container = document.querySelector('.container');
            if (container) {
                document.body.style.zoom = 1; 
                const a4Width = 794; 
                const a4Height = 1123; 
                const contentWidth = 1170; 
                const contentHeight = container.scrollHeight; 
                const scaleX = a4Width / contentWidth;
                const scaleY = a4Height / contentHeight;
                let finalZoom = Math.min(scaleX, scaleY);
                document.body.style.zoom = finalZoom * 0.97;
            }
        });

        window.addEventListener('afterprint', function() {
            document.body.style.zoom = '';
        });

        setTimeout(function() {
            const editorBody = document.querySelector('.content-body');
            if(editorBody) {
                let isResizing = false; let currentImg = null; let startX = 0; let startWidth = 0;
                editorBody.addEventListener('mousedown', function(e) { if (e.target.tagName === 'IMG') { e.preventDefault(); isResizing = true; currentImg = e.target; startX = e.clientX; startWidth = currentImg.getBoundingClientRect().width; document.body.classList.add('resizing'); }});
                window.addEventListener('mousemove', function(e) { if (!isResizing || !currentImg) return; const diff = e.clientX - startX; currentImg.style.width = (startWidth + diff) + 'px'; });
                window.addEventListener('mouseup', function() { if (isResizing) { isResizing = false; currentImg = null; document.body.classList.remove('resizing'); } });
            }
        }, 500);
      <\/script>
    `;


    // </body> 태그 바로 앞에 기능 코드를 붙여넣음
    if(cleanHtml.includes("</body>")) {
        cleanHtml = cleanHtml.replace("</body>", dragFeatureCode + "</body>");
    } else {
        cleanHtml += dragFeatureCode; // </body>가 없으면 맨 뒤에 추가
    }
    // -----------------------------------------------------------

    const newWindow = window.open('', '_blank');
    if (newWindow) { 
        newWindow.document.write(cleanHtml); 
        newWindow.document.close(); 
    } 
    else { alert("팝업 차단을 해제해주세요."); }
  }
</script>

</body>

</html>
